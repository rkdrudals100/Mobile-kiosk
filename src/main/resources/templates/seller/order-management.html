<!doctype html>
<html lang="ko" th:replace="~{./seller/template/base :: layout(~{::title}, ~{::section}, ~{::style}, ~{::script})}" xmlns:th="http://www.thymeleaf.org">

<head>
   <title>모바일 키오스크</title>
</head>
<style></style>
<body style="margin-top: 50px; margin-left: 10px; margin-right: 10px; margin-bottom: 50px;">


<section>
   <!-- 주문 메뉴 관리 -->
   <div class="container" style="padding-top: 50px;">
      <p class="display-6 text-center">주문 현황</p>
      <hr>
      <div class="col-sm-12 column overflow-auto rounded" style="height: 650px; border: 1px solid #cecece;">

         <div class="card text-black bg-Light m-3" th:each="order : ${orders}">
            <div class="row g-1">
               <div class="col-md-2">
                  <div class="card-header" style="height: 100%;">
                     <div>
                        <h1 class="text-center" th:text="${order.id}">001</h1>
                        <hr>
                        <h6 class="btn btn-primary" th:if="${#strings.equals(order.orderStatus, 'ACCEPT')}" th:onclick="'location.href=\''+ @{/order-management/sold?orderId=} + ${order.id} + '\''" style="text-align: center; width: 100%;">판매하기</h6>
                        <h6 class="btn btn-primary disabled" style="text-align: center; width: 100%;" th:unless="${#strings.equals(order.orderStatus, 'ACCEPT')}">판매하기</h6>
                     </div>
                  </div>
               </div>
               <div class="col">
                  <div class="card-body text-left">
                     <span th:each="orderItem : ${order.orderItems}">
                        <span class="card-title list-inline" th:text="${orderItem.getItem().getName()}" style="font-size: 1.7em">상품명</span>
                        <span th:text="'&#40' + ${orderItem.itemCount}" style="font-size: 1.7em"></span><span style="font-size: 1.7em">개)</span><span style="font-size: 1.7em">&nbsp;&nbsp;</span>
                     </span>
                     <hr>
                     <p class="card-text" th:text="${order.requirements}" style="font-size: 1.2em; overflow:hidden; width: 70%; height: 1.2em;">치킨 무 많이 주세요</p>
                     <button class="btn" th:text="${order.totalPrice} + '원'" style="font-size: 1.5em; font-weight: bolder; width: 25%"></button>
                     <button class="btn" th:text="${order.purchaseType.description}" style="font-size: 1.5em; font-weight: bolder; width: 25%; float: right">매장식사 or 포장</button>
                     <button class="btn" th:text="${order.whichPayment.description}" style="font-size: 1.5em; font-weight: bolder; width: 25%; float: right">결제 상태</button>
                  </div>
               </div>
               <div class="col-sm-2">
                  <div class="card-body text-left">
                     <h5 class="text-end" type="button" data-bs-toggle="modal" data-bs-target="#exampleModal" style="margin-bottom: 18%">자세히</h5>
                     <hr>
                  </div>
                  <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                     <!-- <p th:for="${#ids.prev('regions')} /p> -->
                     <button class="btn btn-primary disabled" style="margin-bottom: 2ch;" th:id="${order.id}" th:if="${#strings.equals(order.orderStatus, 'ACCEPT')}" type="button">수락</button>
                     <button class="btn btn-primary" th:onclick="'location.href=\''+ @{/order-management/agree?orderId=} + ${order.id} + '\''" style="margin-bottom: 2ch;" th:id="${order.id}" th:unless="${#strings.equals(order.orderStatus, 'ACCEPT')}" type="button">수락</button>
                     <button type="button" style="margin-right: 2ch; margin-bottom: 2ch;" class="btn btn-danger"
                             data-bs-target="#rejectModal" data-bs-toggle="modal">거절</button>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>

   <!-- 주문 메뉴 자세히 보기 모달-->
   <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
         <div class="modal-content">
            <div class="modal-header">
               <h5 class="modal-title" id="exampleModalLabel">자세히</h5>
               <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
               <pre>
               주문 목록 내용들
               메뉴1
               메뉴2
               메뉴3
               메뉴4
            </pre>
               <hr>
               <pre>
               요청사항 ...
            </pre>

            </div>
            <div class="modal-footer">
               <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">확인</button>
            </div>
         </div>
      </div>
   </div>

   <!-- 주문 메뉴 거절 사유 모달 -->
   <div class="modal fade" id="rejectModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content">
            <div class="modal-header">
               <h5 class="modal-title" id="ModalLabel">거절</h5>
               <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">

               <form action="#" id=reject th:action="@{/order-management/refuse}">
                  <input class="hidden" id="getOrderId" name="getOrderId" th:value="dfsa"></input>
                  <select id="selbox" name="selbox" class="d-block" style="width: 100%;">
                     <option value="soldOut">메뉴가 매진되었습니다.</option>
                     <option value="storeClosed">주방이 마감되었습니다.</option>
                     <option value="direct">사유 직접입력</option>
<!--                     <option value="test" th:text="${order.id}"></option>-->
                  </select>
                  <span> </span>
                  <textarea name="selboxDirect" id="selboxDirect" cols="30" rows="2" style="width: 100%;"></textarea>
               </form>
            </div>
            <div class="modal-footer">
               <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
               <input type="submit" form="reject" class="btn btn-primary"></input>
            </div>
         </div>
      </div>
   </div>

   <!-- JavaScript Bundle with Popper -->
   <script>
      $(function () {
         $("#getOrderId").hide();
         $("#selboxDirect").hide();
         $("#selbox").change(function () {
            if ($("#selbox").val() == "direct") {
               $("#selboxDirect").show();
            } else {
               $("#selboxDirect").hide();
            }
         })
      });
   </script>
</section>

</body>

</html>